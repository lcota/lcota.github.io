dtall$spy
dtall[, "spy"]
rtncol <- "spy"
dtall[, rtncol]
dtall[, sigcol]
dtall[, .(sigcol)]
dtall[, (sigcol)]
dtall[sigcol]
dtall
dtall[[sigcol]]
sigcol <- "nmi.above"
rtncol <- "spy"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
rtncol <- "agg"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
sigcol <- "pmi.above"
rtncol <- "agg"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
sigcol <- "cpi.above"
rtncol <- "agg"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
strat.returns <- trade_by_rule(-dtall[[sigcol]], returns=dtall[[rtncol]])
sigcol <- "cpi.above"
rtncol <- "agg"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
rtncol <- "xme"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
sigcol <- "cpi.above"
rtncol <- "gld"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
colnames(dtall)
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "cpi.above"
rtncol <- "xop"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "cpi.above"
rtncol <- "xhb"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "cpi.above"
rtncol <- "gld"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "cpi.above"
rtncol <- "bil"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "pmi.above"
rtncol <- "bil"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "nmi.above"
rtncol <- "bil"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "nmi.above"
rtncol <- "spts"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "nmi.above"
rtncol <- "tip"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "cpi.above"
rtncol <- "tip"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "cpi.above"
rtncol <- "tip"
strat.returns <- trade_by_rule(-dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "pmi.above"
rtncol <- "tip"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "spts.above"
rtncol <- "tip"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "pmi.above"
rtncol <- "tip"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "pmi.above"
rtncol <- "spts"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "pmi.above"
rtncol <- "spti"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "pmi.above"
rtncol <- "bil"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "pmi.above"
rtncol <- "naivevol"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "pmi.above"
rtncol <- "6040"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "nmi.above"
rtncol <- "6040"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "nmi.above"
rtncol <- "naivevol"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "nmi.above"
rtncol <- "spy"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
dtall[, (pmi.above + nmi.above + cpi.above)/3]
dtall[, comboSignal:=(pmi.above + nmi.above + cpi.above)/3]
dtall
dtall[, comboSignal:=(pmi.above/3 + nmi.above/3 + cpi.above/3)]
dtall
strat.returns <- trade_by_rule(dtall[[comboSignal]], returns=dtall[[rtncol]])
# Inspect returns by signal -------------------------------------------------------------------
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
sigcol <- "comboSignal"
wgt.pmi = 1/3
wgt.nmi = 1/3
wgt.cpi = 1/3
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
rtncol <- "agg"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
rtncol <- "naivevol"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
wgt.pmi = 1/3
wgt.nmi = 1/3
wgt.cpi = 1/3
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "6040"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
wgt.pmi = 1/6
wgt.nmi = 4/6
wgt.cpi = 1/6
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "6040"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
wgt.pmi = .1
wgt.nmi = .8
wgt.cpi = .1
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "6040"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
wgt.pmi = .1
wgt.nmi = 2
wgt.cpi = .1
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "6040"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
wgt.pmi = -.25
wgt.nmi = 1.5
wgt.cpi = -.25
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "6040"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
wgt.pmi = -.25
wgt.nmi = 1.5
wgt.cpi = -.25
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "spy"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
# "spy"             "agg"             "xop"             "xme"             "xhb"             "gld"
# [15] "bil"             "tip"             "spts"            "spti"            "naivevol"        "6040"
wgt.pmi = -.25
wgt.nmi = 1.5
wgt.cpi = -.25
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "agg"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
head(dftotrtn)
head(dfy)
poscount <- function(monthlyReturns){
return(sum(monthlyReturns>0))
}
poscount(dfy$spy)
poscount(-dfy$spy)
c(poscount(dfy$spy), poscount(dfy$agg), poscount(dfy$xop), poscount(dfy$xme), poscount(dfy$xhb), poscount(dfy$gld), poscount(dfy$bil), poscount(dfy$tip), poscount(dfy$spts), poscount(dfy$spti), poscount(dfy$naivevol), poscount(dfy$`6040`))
c(poscount(dfy$spy), poscount(dfy$agg), poscount(dfy$xop), poscount(dfy$xme), poscount(dfy$xhb), poscount(dfy$gld), poscount(dfy$bil), poscount(dfy$tip), poscount(dfy$spts), poscount(dfy$spti), poscount(na.omit(dfy$naivevol), poscount(dfy$`6040`))
c(poscount(dfy$spy), poscount(dfy$agg), poscount(dfy$xop),
poscount(dfy$xme), poscount(dfy$xhb), poscount(dfy$gld),
poscount(dfy$bil), poscount(dfy$tip), poscount(dfy$spts),
poscount(dfy$spti), poscount(na.omit(dfy$naivevol)), poscount(dfy$`6040`))
dim(dfy)
c(poscount(dfy$spy), poscount(dfy$agg), poscount(dfy$xop),
poscount(dfy$xme), poscount(dfy$xhb), poscount(dfy$gld),
poscount(dfy$bil), poscount(dfy$tip), poscount(dfy$spts),
poscount(dfy$spti), poscount(na.omit(dfy$naivevol)), poscount(dfy$`6040`))/dim(dfy)[1]
head(dfy)
c(poscount(dfy$spy), poscount(dfy$agg), poscount(dfy$xop),
poscount(dfy$xme), poscount(dfy$xhb), poscount(dfy$gld),
poscount(dfy$bil), poscount(dfy$tip), poscount(dfy$spts),
poscount(dfy$spti), poscount(na.omit(dfy$naivevol)), poscount(dfy$`6040`))/dim(dfy)[1]
round(c(poscount(dfy$spy), poscount(dfy$agg), poscount(dfy$xop),
poscount(dfy$xme), poscount(dfy$xhb), poscount(dfy$gld),
poscount(dfy$bil), poscount(dfy$tip), poscount(dfy$spts),
poscount(dfy$spti), poscount(na.omit(dfy$naivevol)), poscount(dfy$`6040`))/dim(dfy)[1], 2)
head(dtall)
head(dfx)
dfx <- as.data.table(read_parquet("data/workspace/dfX.pq"))
dfx <- dfx[, .(refmonthyear, cpiyoy, pmnmi, pmpmi, cpiyoy.surprise)]
dfx <- na.omit(dfx)
# Examine data for trading rules --------------------------------------------------------------
# add thresholds for each value
pmi.thresh <- 50
cpi.thresh <- median(na.omit(dfx$cpiyoy))
dfx[, pmi.above := as.integer(pmpmi>pmi.thresh)]
dfx[, nmi.above := as.integer(pmnmi>pmi.thresh)]
dfx[, cpi.above := as.integer(cpiyoy>cpi.thresh)]
head(dfx)
# Try trading rule  ---------------------------------------------------------------------------
setindex(dfx, "refmonthyear")
setindex(dfy, "refmonthyear")
dtall <- data.table::merge.data.table(x=dfx, y=dfy, by="refmonthyear")
wgt.pmi = -.25
wgt.nmi = 1.5
wgt.cpi = -.25
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "agg"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
wgt.pmi = -.25
wgt.nmi = 1.5
wgt.cpi = -.25
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "agg"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
rtncol <- "spy"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
wgt.pmi = 1/3
wgt.nmi = 1/3
wgt.cpi = 1/3
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "spy"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
wgt.pmi = -.25
wgt.nmi = 1.5
wgt.cpi = -.25
dtall[, comboSignal:=(pmi.above*wgt.pmi + nmi.above*wgt.nmi + cpi.above*wgt.cpi)]
sigcol <- "comboSignal"
rtncol <- "spy"
strat.returns <- trade_by_rule(dtall[[sigcol]], returns=dtall[[rtncol]])
library(data.table)
dfx <- as.data.table(read_parquet("data/workspace/dfX.pq"))
dfx <- as.data.table(read_parquet("data/workspace/dfX.pq"))
dfy <- as.data.table(read_parquet("data/workspace/dfY.pq"))
source("C:/Users/lcota/Dropbox/prj/Turnleaf_Analytics/trading_rules.R", echo=TRUE)
dfx <- as.data.table(read_parquet("data/workspace/dfX.pq"))
dfy <- as.data.table(read_parquet("data/workspace/dfY.pq"))
dftotrtn <- as.data.table(read_parquet("data/workspace/dftotrtn.pq"))
dftotrtn$date <- dftotrtn$`__index_level_0__`
dftotrtn$`__index_level_0__` <- NULL
dfx <- dfx[, .(refmonthyear, cpiyoy, pmnmi, pmpmi, cpiyoy.surprise)]
dfx <- as.data.table(read_parquet("data/workspace/dfX.pq"))
dfy <- as.data.table(read_parquet("data/workspace/dfY.pq"))
dftotrtn <- as.data.table(read_parquet("data/workspace/dftotrtn.pq"))
dftotrtn$date <- dftotrtn$`__index_level_0__`
dftotrtn$`__index_level_0__` <- NULL
# dfx <- dfx[, .(refmonthyear, cpiyoy, pmnmi, pmpmi, cpiyoy.surprise)]
# dfx <- na.omit(dfx)
head(dfx)
library(arrow)
library(data.table)
library(ggplot2)
library(data.table)
df <- as.data.table(read_parquet("data/results/results.pq"))
dt <- as.data.table(df)
dt
dt[, .(sd(base_rtn) * sqrt(12)), by=ticker]
dt[, .(sd(base_rtn) * sqrt(12)), by=ticker]
dt[, .(sd(y_rtn) * sqrt(12)), by=ticker]
dt[, .(basevol=sd(y_rtn) * sqrt(12)), by=ticker]
head(dt)
dt[, .(basevol=sd(y_rtn) * sqrt(12),
lsvol=sd(strat_ls_rtn) * sqrt(12),
lovol=sd(strat_lo_rtn) *sqrt(12)), by=ticker]
lovol=round(sd(strat_lo_rtn) *sqrt(12), 4), by=ticker]
dt[, .(basevol=round(sd(y_rtn) * sqrt(12), 4),
lsvol=round(sd(strat_ls_rtn) * sqrt(12), 4),
lovol=round(sd(strat_lo_rtn) *sqrt(12), 4)), by=ticker]
dt[, .(basevol=round(sd(y_rtn) * sqrt(12), 4) * 100,
lsvol=round(sd(strat_ls_rtn) * sqrt(12), 4),
lovol=round(sd(strat_lo_rtn) *sqrt(12), 4)), by=ticker]
dt[, .(basevol=round(sd(y_rtn) * sqrt(12), 4) * 100,
lsvol=round(sd(strat_ls_rtn) * sqrt(12), 4) * 100,
lovol=round(sd(strat_lo_rtn) *sqrt(12), 4) * 100), by=ticker]
vols <- dt[, .(basevol=round(sd(y_rtn) * sqrt(12), 4) * 100,
lsvol=round(sd(strat_ls_rtn) * sqrt(12), 4) * 100,
lovol=round(sd(strat_lo_rtn) *sqrt(12), 4) * 100), by=ticker]
head(dt)
dt[, .(last(base_totrtn), last(strat_lo_tr), last(strat_ls_tr)), by=ticker]
round(dt[, .(last(base_totrtn), last(strat_lo_tr), last(strat_ls_tr)), by=ticker], 2)
dt[, .(
basetr=round(last(base_totrtn), 2),
lotr=round(last(strat_lo_tr), 2),
lstr=round(last(strat_ls_tr), 2)), by=ticker]
trrs <- dt[, .(
basetr=round(last(base_totrtn), 2),
lotr=round(last(strat_lo_tr), 2),
lstr=round(last(strat_ls_tr), 2)), by=ticker]
dt
dt[, cumprod(1+base_totrtn), by=ticker]
dt[, cumprod(1+base_totrtn)*100, by=ticker]
dt[ticker='bnd', cumprod(1+base_totrtn)*100, by=ticker]
dt[ticker=='bnd', cumprod(1+base_totrtn)*100, by=ticker]
dt[ticker=='bnd', .(cumprod(1+base_totrtn)), by=ticker]
dt[ticker=='bnd', .((1+base_totrtn)), by=ticker]
dt[ticker=='bnd', .(cumprod(1+base_rtn)), by=ticker]
dt
dt[ticker=='bnd', .(cumprod(1+y_rtn)), by=ticker]
dt[ticker=='bnd', .(cumprod(1+y_rtn)*100), by=ticker]
dt[, .(cumprod(1+y_rtn)*100), by=ticker]
dt
trrs <- dt[, .(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_tr)*100), by=ticker]
trrs <- dt[, .(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_tr)*100,
lstr=cumprod(1+strat_ls_tr)*100), by=ticker]
trrs
dt[ticker=='bnd', .(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_tr)*100,
lstr=cumprod(1+strat_ls_tr)*100), by=ticker]
dt[ticker=='bnd',
.(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_tr)*100,
lstr=cumprod(1+strat_ls_tr)*100),
by=ticker]
dt[ticker=='bnd',
.(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_rtn)*100,
lstr=cumprod(1+strat_ls_rtn)*100),
by=ticker]
dt[,
.(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_rtn)*100,
lstr=cumprod(1+strat_ls_rtn)*100),
by=ticker]
trrs <- dt[,
.(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_rtn)*100,
lstr=cumprod(1+strat_ls_rtn)*100),
by=ticker]
trrs
View(trrs)
install.packages("clipr")
library(clipr)
setkey(trrs, ticker)
setkey(vols, ticker)
vols
cbind(trrs, vols)
trrs <- last(dt[,
.(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_rtn)*100,
lstr=cumprod(1+strat_ls_rtn)*100),
by=ticker])
setkey(trrs, ticker)
setkey(vols, ticker)
cbind(trrs, vols)
results <- cbind(trrs, vols)
results
head(results)
trrs <- trrs[, .(last(basetr), last(lotr), last(lstr)), by=ticker]
setkey(trrs, ticker)
setkey(vols, ticker)
results <- cbind(trrs, vols)
head(results)
trrs <- dt[,
.(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_rtn)*100,
lstr=cumprod(1+strat_ls_rtn)*100),
by=ticker]
trrs <- trrs[, .(last(basetr), last(lotr), last(lstr)), by=ticker]
trrs <- dt[,
.(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_rtn)*100,
lstr=cumprod(1+strat_ls_rtn)*100),
by=ticker]
trrs[, .(last(basetr), last(lotr), last(lstr)), by=ticker]
trrs <- trrs[, .(last(basetr), last(lotr), last(lstr)), by=ticker]
trrs
trrs <- trrs[, .(basetr=last(basetr), lotr=last(lotr), lstr=last(lstr)), by=ticker]
trrs <- dt[,
.(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_rtn)*100,
lstr=cumprod(1+strat_ls_rtn)*100),
by=ticker]
trrs <- trrs[, .(basetr=last(basetr), lotr=last(lotr), lstr=last(lstr)), by=ticker]
trrs
setkey(trrs, ticker)
setkey(vols, ticker)
results <- cbind(trrs, vols)
head(results)
trrs <- dt[,
.(basetr=cumprod(1+y_rtn)*100,
lotr=cumprod(1+strat_lo_rtn)*100,
lstr=cumprod(1+strat_ls_rtn)*100),
by=ticker]
trrs <- trrs[,
.(basetr=round(last(basetr), 2),
lotr=round(last(lotr), 2),
lstr=round(last(lstr), 2)),
by=ticker]
setkey(trrs, ticker)
setkey(vols, ticker)
results <- cbind(trrs, vols)
head(results)
clipr::write_clip(results)
ref <- fread("data/syms.csv")
ref
ref <- fread("data/syms.csv", header=T)
ref
head(ref)
ref$V1 <- NULL
ref
head(ref)
colnames(ref) <- c('ticker', 'name', 'launchdate', 'group', 'subgroup', 'maturity', 'duration')
head(ref)
colnames(ref) <- c('ticker', 'name', 'launchdate', 'group', 'subgroup', 'style', 'maturity', 'duration')
setkey(ref, ticker)
results <- merge(results, ref, by='ticker')
results <- merge(results, ref, by='ticker', all.y = F)
setindex(ref, ticker)
setindex(results, ticker)
merge(results, ref)
merge(results, ref, by='ticker')
ref
head(ref)
results$group <- ref$group
clipr::write_clip(ref)
tickers = c(
"XLC",  # Communication Services
"XLY",  # Consumer Discretionary
"XLP",  # Consumer Staples
"XLE",  # Energy
"XLF",  # Financials
"XLV",  # Health Care
"XLI",  # Industrials
"XLB",  # Materials
"XLRE",  # Real Estate
"XLU",  # Utilities
)
tickers = c(
"XLC",  # Communication Services
"XLY",  # Consumer Discretionary
"XLP",  # Consumer Staples
"XLE",  # Energy
"XLF",  # Financials
"XLV",  # Health Care
"XLI",  # Industrials
"XLB",  # Materials
"XLRE",  # Real Estate
"XLU"  # Utilities
)
require(quantmod)
getSymbols(tickers, from="2000-01-01")
require(data.table)
require(ggplot2)
require(tidyverse)
chartSeries(XLC)
head(XLC)
head(XLE)
